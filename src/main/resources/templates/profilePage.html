<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link th:href="@{/css/bootstrap.css}" rel="stylesheet">
  <link th:href="@{/css/profilePicturePicker.css}" rel="stylesheet">
  <title>Gardener's Grove</title>
</head>

<body>
  <div th:replace="fragments/navBar.html :: navBar('profile')" th:with="loggedIn=${loggedIn}"></div>
  <div class="container-lg my-5">
    <div class="text-center">
        <h1>My Profile</h1>
    </div>
    <div class="row justify-content-center my-5">
        <div class="col-lg-3 p-3">
            <div class="border rounded-3 p-3">
                    <form th:action="@{/profile}" method="post" enctype="multipart/form-data" class="d-flex flex-row justify-content-center">
                        <div class="profile_picture_container small_pic">
                            <input type="hidden" th:value="${profilePicture}">
                            <img id="imageToChange"
                                th:src="@{${profilePicture == null ? '/images/default_profile_picture.png' : '/files/users/' + profilePicture}}"
                                alt="User's profile picture">
                            <label for="profilePictureInput">+</label>
                            <input id="profilePictureInput" type="file" th:name="profilePictureInput" accept="image/*"
                                onChange="handleFileSelect(event); this.form.submit()">
                        </div>
                        <p th:if="${profilePictureError}" class="text-danger fs-6" th:text="${profilePictureError}"></p>
                    </form>
                    <div class="mb-3">
                        <label for="name" class="form-label">Name</label>
                        <input readonly id="name" type="text" class="form-control" th:value="*{userName}">
                    </div>
            
                    <div th:if="${dateOfBirth}" class="mb-3">
                        <label for="dateOfBirth" class="form-label">Date of Birth</label>
                        <input readonly id="dateOfBirth" type="text" class="form-control" th:value="*{dateOfBirth}">
                    </div>
    
                    <div class="mb-3">
                        <label for="dateOfBirth" class="form-label">Email Address</label>
                        <input readonly id="dateOfBirth" type="text" class="form-control" th:value="*{emailAddress}">
                    </div>
    
                    <div class="text-center">
                        <a th:href="@{/profile/edit}"><button class="btn btn-primary">Edit Profile</button></a>
                        <a th:href="@{/home}"><button class="btn btn-secondary">Home</button></a>
                    </div>
            </div>
        </div>
    </div>
</div>
  <script th:src="@{/js/preventEnterSubmit.js}"></script>
  <script th:src="@{/js/inputCharacterLimit.js}"></script>
  <div th:replace="fragments/bootstrapScripts.html"></div>
  <script th:src="@{/js/imagePicker.js}"></script>
</body>

</html>